!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Yngwie=t():e.Yngwie=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Element:()=>i,Error:()=>r,Listener:()=>o,Node:()=>n,TextNode:()=>s,Transform:()=>a});class r extends Error{constructor(e,t){super(e),this.data=`${t}`}log(){console.log(this.stack),console.log("What Failed: ",this.data)}}class n{constructor(e){if("string"!=typeof e)throw new r("Value of YngwieNode must be STRING",e);this._value=e,this._parent=void 0,this._first=void 0,this._last=void 0,this._next=void 0,this._prev=void 0}children(){let e=this._first,t=[];for(;e;)t.push(e),e=e._next;return t}append(e){if(e instanceof n)return e._parent&&e.detach(),void 0!==this._first?(e._prev=this._last,this._last._next=e,this._last=e):(this._first=e,this._last=e),e._parent=this,this;throw new r("Can only apppend YngwieNode to other YngwieNodes",e)}appends(e){if(e instanceof Array)return e.reduce(((e,t)=>this.append(t)),this);throw new r("Expected array as arguemnt",e)}detach(){return this._prev?this._prev._next=this._next:this._parent&&(this._parent._first=this._next),this._next&&(this._next._prev=this._prev),this._next=void 0,this._prev=void 0,this._parent=void 0,this}insertBefore(e){if(e instanceof n)return e._prev=this._prev,e._next=this,e._parent=this._parent,this._prev?this._prev._next=e:this._parent&&(this._parent._first=e),this._prev=e,this;throw new r("Can only insert a YngwieNode before other YngwieNodes",e)}replaceWith(e){if(e instanceof n){if(void 0!==this._parent)return this.insertBefore(e),this.detach(),e;throw new r("Can only replace YngwieNode if YngwieNode being replaced has parent",this)}throw new r("Can only replace a YngwieNode with another YngwieNode",e)}clone(){let e=`${this._value}`,t=new n(e);return this.children().reduce(((e,r)=>(t=r.clone(),e.append(t))),t)}step(e,t){return next=e(this,t),next&&next.step(e,t),t}parse(e,t){return n.parse(this,(r=>{t=e(r,t)})),t}static init(e){return new n(e)}static parse(e,t){if(!(e instanceof n))throw new r("Can only parse a YngwieNode",e);for(t(e),e=e._first;e;)n.parse(e,t),e=e._next}}class i extends n{constructor(e,t,r,n){super(e.toUpperCase()),this._attribs=t||{},this._text=r,this._listeners=[]}tagName(){return this._value}attribs(e){if(void 0===e)return this._attribs;if("object"==typeof e)return this._attribs=e,this;throw new r("YngwieElement attributes can only be set with OBJECT",e)}hasAttribute(e){return this._attribs.hasOwnProperty(e)}getAttribute(e){return this._attribs[e]}setAttribute(e,t){return this._attribs[e]=t,this}removeAttribute(e){return delete this._attribs[e],this}text(e){if(void 0===e)return this._text;if("string"==typeof e)return this._text=e,this;throw new r("Text of element can only be set with a STRING",e)}removeText(){return this._text=void 0,this}getElementsBy(e){return this.parse(((t,r)=>(t instanceof i&&!0===e(t)&&r.push(t),r)),[])}getElementsByTagName(e){return this.getElementsBy((t=>t.tagName()===e))}getElementsByAttribute(e,t){return this.getElementsBy((r=>!!r.hasAttribute(e)&&(void 0===t||r.getAttribute(e)===t)))}getElementsByClass(e){return this.getElementsByAttribute("class",e)}getElementByID(e){return this.getElementsByAttribute("id",e).pop()}on(e,t){let r=Yngwie.Listener.init(e,t);return this._listeners.push(r),this}clone(){let e=`${this._value}`,t=Object.keys(this._attribs).reduce(((e,t)=>(e[t]=`${this._attribs[t]}`,e)),{}),r=void 0!==this._text?`${this._text}`:void 0,n=this._listeners.map((e=>e.clone())),s=new i(e,t,r,n);return this.children().reduce(((e,t)=>(t=t.clone(),e.append(t))),s)}render(e,t){let r=void 0===t?document:t,n=Object.keys(this._attribs).reduce(((e,t)=>(e.setAttribute(t,this._attribs[t]),e)),r.createElement(this._value));if(n=this._listeners.reduce(((e,t)=>t.render(e,this)),n),"string"==typeof this._text){let e=r.createTextNode(this._text);n.appendChild(e)}let i=this.children().reduce(((e,t)=>(t=t.render(),e.appendChild(t),e)),n);return void 0!==e&&("string"==typeof e?r.querySelector(e).appendChild(i):e.appendChild(i)),i}static init(e,t,r,n){return new i(e,t,r,n)}static renderTo(e,t,n){let s=void 0===n?document:n;if(t instanceof Array){let n="string"==typeof e?s.querySelector(e):e;return t.reduce(((e,t)=>{if(t instanceof i)return t.render(e),e;throw new r("Only YngwieElement can be rendered to target",t)}),n)}throw new r("Expected array as argument",t)}static inject(e,t,n){if(t instanceof i){let r=void 0===n?document:n,i="string"==typeof e?r.querySelector(e):e,s=t.render();return i.replaceWith(s),i}throw new r("Only YngwieElement can be injected into target",t)}}class s extends n{constructor(e){super(e)}text(){return this._value}append(e){if("string"==typeof e)return this._value+=e,this;if(e instanceof s)return this._value+=e.text(),this;throw new r("Only STRINGs and other YngwieTextNodes can append a YngwieTextNode",e)}render(e,t){let r=void 0===t?document:t,n=r.createTextNode(this._value);return void 0!==e&&("string"==typeof e&&r.querySelector(e),e.appendChild(n)),n}clone(){return new s(`${this._value}`)}static init(e){return new s(e)}}class o{constructor(e,t){this._evtName=e,this._fns=t||[]}add(e){return this._fns.push(e),this}clone(){let e=`${this._evtName}`,t=this._fns.map((e=>new Function("evt","elem",e.toString())));return new o(e,t)}render(e,t){return this._fns.reduce(((e,r)=>(e.addEventListener(this._evtName,(function(n){r.call(void 0===t?e:t,n,e)})),e)),e)}static init(e,t){return void 0!==t?new o(e,!0===Array.isArray(t)?t:[t]):new o(e)}}class a{constructor(e){this._value=e,this._type=a.getType(e)}toNODE(){switch(this._type){case"NODE":return this._value;case"STRING":return(new DOMParser).parseFromString(this._value,"text/html").body.firstChild;case"YNGWIE":return this._value.render();default:throw new a("Cannot transform to NODE from unsuppoted type",this._value)}}toSTRING(){switch(this._type){case"NODE":return 1===this._value.nodeType?this._value.outerHTML:this._value.nodeValue;case"STRING":return this._value;case"YNGWIE":console.log(this._value);let e=this._value.render();return console.log(e),1===e.nodeType?e.outerHTML:e.nodeValue;default:throw new a("Cannot transform to STRING from unsuppoted type",this._value)}}toYNGWIE(){switch(this._type){case"NODE":case"STRING":return a.init(this._value);case"YNGWIE":return this._value;default:throw new a("Cannot transform to YngwieElement from unsuppoted type",this._value)}}static init(e){return h("STRING"===a.getType(e)?a.toNODE(e):e)}static toNODE(e){return new a(e).toNODE()}static toSTRING(e){return new a(e).toSTRING()}static toYNGWIE(e){return new a(e).toYNGWIE()}static getType(e){return e instanceof Node?"NODE":"string"==typeof e?"STRING":e instanceof n?"YNGWIE":void 0}}function h(e,t){if(1===e.nodeType){let r=function(e){return Array.from(e.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{})}(e),n=new i(e.tagName,r);t=void 0===t?n:t.append(n)}if(3===e.nodeType){let r=new s(e.nodeValue);t=void 0===t?r:t.append(r)}for(e=e.firstChild;e;){let r=h(e);void 0!==r&&t.append(r),e=e.nextSibling}return t}return t})()}));