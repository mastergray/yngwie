!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Yngwie=t():e.Yngwie=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Controller:()=>i,Element:()=>s,Error:()=>r,Node:()=>n,TextNode:()=>o,transform:()=>a});class r extends Error{constructor(e,t){super(e),this.data=`${t}`}log(){console.log(this.stack),console.log("What Failed: ",this.data)}}class n{constructor(e){this._value=e,this._parent=void 0,this._first=void 0,this._last=void 0,this._next=void 0,this._prev=void 0}children(){let e=this._first,t=[];for(;e;)t.push(e),e=e._next;return t}append(e){if(e instanceof n)return e._parent&&e.detach(),void 0!==this._first?(e._prev=this._last,this._last._next=e,this._last=e):(this._first=e,this._last=e),e._parent=this,this;throw new r("Can only apppend YngwieNode to other YngwieNodes",e)}appends(e){if(e instanceof Array)return e.reduce(((e,t)=>this.append(t)),this);throw new r("Expected array as arguemnt",e)}detach(){return this._prev?this._prev._next=this._next:this._parent&&(this._parent._first=this._next),this._next&&(this._next._prev=this._prev),this._next=void 0,this._prev=void 0,this._parent=void 0,this}insertBefore(e){if(e instanceof n)return e._prev=this._prev,e._next=this,e._parent=this._parent,this._prev?this._prev._next=e:this._parent&&(this._parent._first=e),this._prev=e,this;throw new r("Can only insert a YngwieNode before other YngwieNodes",e)}replaceWith(e){if(e instanceof n){if(void 0!==this._parent)return this.insertBefore(e),this.detach(),e;throw new r("Can only replace YngwieNode if YngwieNode being replaced has parent",this)}throw new r("Can only replace a YngwieNode with another YngwieNode",e)}clone(){let e=`${this._value}`,t=new n(e);return this.children().reduce(((e,r)=>(t=r.clone(),e.append(t))),t)}step(e,t){return next=e(this,t),next&&next.step(e,t),t}parse(e,t){return n.parse(this,(r=>{t=e(r,t)})),t}static init(e){return new n(e)}static parse(e,t){if(!(e instanceof n))throw new r("Can only parse a YngwieNode",e);for(t(e),e=e._first;e;)n.parse(e,t),e=e._next}}class i{constructor(e,t){this._evtName=e,this._fns=t||[]}add(e){return this._fns.push(e),this}clone(){let e=`${this._evtName}`,t=this._fns.map((e=>e.toString()));return new i(e,t)}render(e){return this._fns.reduce(((e,t)=>(e.addEventListener(this._evtName,t),e)),e)}static init(e,t){return new i(e,!0===Array.isArray(t)?t:[t])}}class s extends n{constructor(e,t,r,n){super(e),this._attribs=t||{},this._text=void 0===r?null:r,this._controllers=[]}attribs(e){return void 0===e?this._attribs:(this._attribs=e,this)}hasAttribute(e){return this._attribs.hasOwnProperty(e)}getAttribute(e){return this._attribs[e]}setAttribute(e,t){return this._attribs[e]=t,this}text(e){return void 0===e?this._text:(this._text=e,this)}getElementsByTagName(e){return this.parse(((t,r)=>(r._value===e&&t.push(r),t)),[])}getElementsByAttribute(e,t){return this.parse(((r,n)=>(r instanceof s&&r.hasAttribute(e)&&(void 0===t||r.getAttribute(e)===t)&&n.push(r),n)),[])}getElementsByClass(e){return this.getElementsByAttribute("class",e)}getElementByID(e){return this.getElementsByAttribute("id",e).pop()}on(e,t){let r=i.init(e,t);return this._controllers.push(r),this}clone(){let e=`${this._value}`,t=Object.keys(this._attribs).reduce(((e,t)=>(e[t]=`${this._attribs[t]}`,e)),{}),r=void 0!==this._text?`${this._text}`:void 0,n=this._controllers.map((e=>e.clone())),i=new s(e,t,r,n);return this.children().reduce(((e,t)=>(t=t.clone(),e.append(t))),i)}render(e){let t=Object.keys(this._attribs).reduce(((e,t)=>(e.setAttribute(t,this._attribs[t]),e)),document.createElement(this._value));if(t=this._controllers.reduce(((e,t)=>t.render(e)),t),"string"==typeof this._text){let e=document.createTextNode(this._text);t.appendChild(e)}let r=this.children().reduce(((e,t)=>(t=t.render(),e.appendChild(t),e)),t);return void 0!==e&&("string"==typeof e?document.querySelector(e).appendChild(r):e.appendChild(r)),r}static init(e,t,r,n){return new s(e,t,r,n)}static renderTo(e,t){let n="string"==typeof e?document.querySelector(e):e;return t.reduce(((e,t)=>{if(t instanceof s)return t.render(e),e;throw new r("Only YngwieElement can be rendered to target",t)}),n)}static inject(e,t){if(t instanceof s){let r="string"==typeof e?document.querySelector(e):e,n=t.render();return r.replaceWith(n),r}throw new r("Only YngwieElement can be injected into target",t)}}class o extends n{constructor(e){super(e)}render(){return document.createTextNode(this._value)}append(e){if("string"==typeof e)return this._value+=e,this;throw new r("Only STRINGs can append YngwieTextNodes",e)}clone(){return new o(`${this._value}`)}init(e){return new o(e)}}function a(e){return h("string"==typeof e?function(e){return(new DOMParser).parseFromString(e,"text/html").body.firstElementChild}(e):e)}function h(e,t){if(1===e.nodeType){let r=function(e){return Array.from(e.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{})}(e),n=new s(e.tagName,r);t=void 0===t?n:t.append(n)}if(3===e.nodeType){let r=new o(e.nodeValue);t=void 0===t?r:t.append(r)}for(e=e.firstChild;e;){let r=h(e);void 0!==r&&t.append(r),e=e.nextSibling}return t}return t})()}));